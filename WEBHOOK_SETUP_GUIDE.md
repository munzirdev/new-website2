# ุฏููู ุฅุนุฏุงุฏ ูุธุงู ุงูู Webhooks ููุชูููุฌุฑุงู

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅูุดุงุก ูุธุงู webhook ุดุงูู ูุฅุฑุณุงู ุฅุดุนุงุฑุงุช ุงูุชูููุฌุฑุงู ูุฌููุน ุฃููุงุน ุงูุทูุจุงุช ูู ุงููููุน. ูุฐุง ุงููุธุงู ูุถูู ุฃูู ุชุชููู ุฅุดุนุงุฑุงุช ููุฑูุฉ ุนูู ุงูุชูููุฌุฑุงู ุนูุฏ:

- ุทูุจุงุช ุงูุชุฑุฌูุฉ
- ุทูุจุงุช ุงูุชุฃููู ุงูุตุญู
- ุทูุจุงุช ุงูุนูุฏุฉ ุงูุทูุนูุฉ
- ุทูุจุงุช ุชูุนูู ุงูุชุฃููู ุงูุตุญู
- ุทูุจุงุช ุงูุฎุฏูุงุช ุงูุนุงูุฉ
- ุทูุจุงุช ุงูุฏุนู ุงูููู ูุงููุญุงุฏุซุงุช

## ุงููููุฒุงุช

### ๐ ุฅุดุนุงุฑุงุช ุดุงููุฉ
- **ุฌููุน ุฃููุงุน ุงูุทูุจุงุช**: ุชุบุทูุฉ ูุงููุฉ ูุฌููุน ุงูููุงุฐุฌ ูุงูุทูุจุงุช ูู ุงููููุน
- **ูุนูููุงุช ููุตูุฉ**: ุงุณู ุงูุนูููุ ุงูุจุฑูุฏ ุงูุฅููุชุฑูููุ ุฑูู ุงููุงุชูุ ุชูุงุตูู ุงูุทูุจ
- **ุฃุฒุฑุงุฑ ุชูุงุนููุฉ**: ุฃุฒุฑุงุฑ ููุฑุฏ ุงูุณุฑูุน ูุนุฑุถ ุงูุชูุงุตูู

### ๐ฏ ุชุฎุตูุต ุงูุฅุดุนุงุฑุงุช
- **ุฃููููุงุช ูููุฒุฉ**: ูู ููุน ุทูุจ ูู ุฃููููุฉ ุฎุงุตุฉ
- **ุฃููุงู ุงูุฃููููุฉ**: ุชูููุฒ ุงูุทูุจุงุช ุญุณุจ ุงูุฃููููุฉ (ูุณุชุนุฌูุ ุนุงููุ ูุชูุณุทุ ููุฎูุถ)
- **ูุนูููุงุช ุฅุถุงููุฉ**: ุชูุงุตูู ุฎุงุตุฉ ุจูู ููุน ุทูุจ

### โ๏ธ ุฅุฏุงุฑุฉ ุณููุฉ
- **ุชูุนูู/ุฅูุบุงุก ุชูุนูู**: ุชุญูู ูุงูู ูู ุงููุธุงู
- **ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช**: ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ุชุฌุฑูุจูุฉ
- **ูุฑุงูุจุฉ ุงูุญุงูุฉ**: ุนุฑุถ ุญุงูุฉ ุงูุงุชุตุงู ูุงูุงุฎุชุจุงุฑุงุช

## ุงูุฅุนุฏุงุฏ

### 1. ุฅุนุฏุงุฏ ุจูุช ุงูุชูููุฌุฑุงู

#### ุฅูุดุงุก ุงูุจูุช
1. ุงุฐูุจ ุฅูู [@BotFather](https://t.me/botfather) ุนูู ุงูุชูููุฌุฑุงู
2. ุฃุฑุณู `/newbot`
3. ุงุชุจุน ุงูุชุนูููุงุช ูุฅูุดุงุก ุงูุจูุช
4. ุงุญูุธ `Bot Token` ุงูุฐู ุณุชุญุตู ุนููู

#### ุงูุญุตูู ุนูู Chat ID
1. ุงุจุฏุฃ ูุญุงุฏุซุฉ ูุน ุงูุจูุช ุงูุฐู ุฃูุดุฃุชู
2. ุงุฐูุจ ุฅูู: `https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getUpdates`
3. ุงุจุญุซ ุนู `"chat":{"id":` ูุงุญูุธ ุงูุฑูู

### 2. ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช

#### ุฅูุดุงุก ุฌุฏูู telegram_config
```sql
CREATE TABLE telegram_config (
  id SERIAL PRIMARY KEY,
  bot_token TEXT NOT NULL,
  admin_chat_id TEXT NOT NULL,
  is_enabled BOOLEAN DEFAULT true,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- ุฅุฏุฑุงุฌ ุงูุฅุนุฏุงุฏุงุช ุงูุฃูููุฉ
INSERT INTO telegram_config (bot_token, admin_chat_id, is_enabled) 
VALUES ('YOUR_BOT_TOKEN', 'YOUR_CHAT_ID', true);
```

### 3. ุฅุนุฏุงุฏ ุงููููุน

#### ุชุญุฏูุซ ููู .env
```env
# Telegram Bot Configuration
TELEGRAM_BOT_TOKEN=your_bot_token_here
TELEGRAM_ADMIN_CHAT_ID=your_chat_id_here
```

## ุงูุงุณุชุฎุฏุงู

### ุงููุตูู ูุฅุนุฏุงุฏุงุช ุงูู Webhooks

1. ุงุฐูุจ ุฅูู ููุญุฉ ุงูุชุญูู: `/admin`
2. ุงููุฑ ุนูู ุชุจููุจ **"ุงูู Webhooks"**
3. ุณุชุฌุฏ ูุงุฌูุฉ ุฅุฏุงุฑุฉ ุดุงููุฉ

### ุงูุชุญูู ูู ุงููุธุงู

#### ุชูุนูู/ุฅูุบุงุก ุชูุนูู
- ุงููุฑ ุนูู ุฒุฑ **"ุชูุนูู"** ุฃู **"ุฅูุบุงุก ุงูุชูุนูู"**
- ุณูุชู ุชุญุฏูุซ ุงูุญุงูุฉ ููุฑุงู

#### ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช
- ุงููุฑ ุนูู ุฒุฑ **"ุฅุฑุณุงู ุฅุดุนุงุฑ ุชุฌุฑูุจู"**
- ุชุญูู ูู ุงูุชูููุฌุฑุงู ูุฑุคูุฉ ุงูุฅุดุนุงุฑ

### ูุฑุงูุจุฉ ุงูุญุงูุฉ

#### ูุคุดุฑุงุช ุงูุญุงูุฉ
- ๐ข **ููุนู**: ุงููุธุงู ูุนูู ุจุดูู ุทุจูุนู
- ๐ด **ูุนุทู**: ุงููุธุงู ูุชููู
- ๐ **ุงุชุตุงู ุงูุชูููุฌุฑุงู**: ุญุงูุฉ ุงูุงุชุตุงู ุจุงูุจูุช

## ุฃููุงุน ุงูุฅุดุนุงุฑุงุช

### ๐ฌ ุงูุฏุนู ุงูููู
- ุทูุจุงุช ุงููุญุงุฏุซุฉ
- ุงูุฑุณุงุฆู ุงูุฌุฏูุฏุฉ
- ุงูุฑุณุงุฆู ุงููุณุชุนุฌูุฉ
- ุทูุจุงุช ููุซู ุฎุฏูุฉ ุนููุงุก

### ๐ ุงูุชุฑุฌูุฉ
- ุทูุจุงุช ุชุฑุฌูุฉ ุงููุซุงุฆู
- ูุนูููุงุช ุงูุนููู
- ุงููููุงุช ุงููุฑููุฉ

### ๐ก๏ธ ุงูุชุฃููู
- ุทูุจุงุช ุงูุชุฃููู ุงูุตุญู
- ุชูุนูู ุงูุชุฃููู ุงูุตุญู
- ูุนูููุงุช ุงูุนููู ูุงููุซุงุฆู

### ๐ ุงูุนูุฏุฉ ุงูุทูุนูุฉ
- ุทูุจุงุช ุงูุนูุฏุฉ ุงูุทูุนูุฉ
- ุนุฏุฏ ุงููุฑุงูููู
- ููุทุฉ ุงูุญุฏูุฏ ูุงูุชุงุฑูุฎ

### ๐ ุงูุฎุฏูุงุช ุงูุนุงูุฉ
- ุทูุจุงุช ุงูุฎุฏูุงุช ุงููุชููุนุฉ
- ุชูุงุตูู ุงูุทูุจ
- ุงููููุงุช ุงููุฑููุฉ

## ุชูุณูู ุงูุฅุดุนุงุฑุงุช

### ูุซุงู ูุฅุดุนุงุฑ ุทูุจ ุชุฑุฌูุฉ
```
๐ ุทูุจ ุชุฑุฌูุฉ ุฌุฏูุฏ

๐ค ูุนูููุงุช ุงูุนููู:
โข ุงูุงุณู: ุฃุญูุฏ ูุญูุฏ
โข ุงูุจุฑูุฏ ุงูุฅููุชุฑููู: ahmed@example.com
โข ุฑูู ุงููุงุชู: +966501234567

๐ ุชูุงุตูู ุงูุทูุจ:
ุชุฑุฌูุฉ ุดูุงุฏุฉ ุงููููุงุฏ ูู ุงูุนุฑุจูุฉ ุฅูู ุงูุฅูุฌููุฒูุฉ

๐ ูุนูููุงุช ุฅุถุงููุฉ:
โข ููุน ุงูุทูุจ: ุชุฑุฌูุฉ
โข ุงูุฃููููุฉ: ๐ก ูุชูุณุท
โข ุงูุญุงูุฉ: ูุนูู
โข ๐ ูุฑูู ููู: document.pdf

๐ ูุนุฑู ุงูุทูุจ: 12345

โฐ ุงูุชูููุช:
2024/01/15 14:30:25
```

### ุฃุฒุฑุงุฑ ุงูุชูุงุนู
- **๐ ุงูุชูุงุตู ูุน ุงูุนููู**: ููุฑุฏ ุงููุจุงุดุฑ
- **๐ ุนุฑุถ ุงูุทูุจ**: ูุนุฑุถ ุงูุชูุงุตูู ุงููุงููุฉ
- **โ ุชู ุงูุชุนุงูู ูุนู**: ูุฅุบูุงู ุงูุทูุจ

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุดุงูู ุดุงุฆุนุฉ

#### ุงูุฅุดุนุงุฑุงุช ูุง ุชุตู
1. ุชุญูู ูู ุตุญุฉ `Bot Token`
2. ุชุฃูุฏ ูู ุฃู `Chat ID` ุตุญูุญ
3. ุชุฃูุฏ ูู ุฃู ุงูุจูุช ููุนู
4. ุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงูุฎุตูุตูุฉ

#### ุฎุทุฃ ูู ุงูุงุชุตุงู
1. ุชุญูู ูู ุงุชุตุงู ุงูุฅูุชุฑูุช
2. ุชุฃูุฏ ูู ุฃู API ุงูุชูููุฌุฑุงู ูุชุงุญ
3. ุชุญูู ูู ุตูุงุญูุงุช ุงูุจูุช

#### ุฅุดุนุงุฑุงุช ููุฑุฑุฉ
1. ุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงูู webhook
2. ุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ุชูุฑุงุฑ ูู ุงูููุฏ
3. ุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุณุฌูุงุช ุงูุฃุฎุทุงุก
```javascript
// ูู ูุญุฏุฉ ุงูุชุญูู ุณุชุฌุฏ ุฑุณุงุฆู ูุซู:
โ ุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ุทูุจ ุงูุชุฑุฌูุฉ ุฅูู ุงูุชูููุฌุฑุงู
โ ุฎุทุฃ ูู ุฅุฑุณุงู ุฅุดุนุงุฑ ุทูุจ ุงูุชุฃููู: Network error
```

## ุงูุชุฎุตูุต

### ุฅุถุงูุฉ ุฃููุงุน ุทูุจุงุช ุฌุฏูุฏุฉ

#### 1. ุชุญุฏูุซ telegramService.ts
```typescript
// ุฅุถุงูุฉ ููุน ุทูุจ ุฌุฏูุฏ
export type RequestType = 
  | 'chat_support'
  | 'translation'
  | 'insurance'
  | 'voluntary_return'
  | 'health_insurance_activation'
  | 'service_request'
  | 'general_inquiry'
  | 'new_request_type'; // ุฅุถุงูุฉ ููุง
```

#### 2. ุฅุถุงูุฉ ุฏุงูุฉ ุฅุดุนุงุฑ ุฌุฏูุฏุฉ
```typescript
async sendNewRequestTypeNotification(requestData: any) {
  return this.sendRequestNotification({
    type: 'new_request_type',
    title: 'ุทูุจ ุฌุฏูุฏ',
    description: requestData.description,
    // ... ุจุงูู ุงูุจูุงูุงุช
  });
}
```

#### 3. ุชุญุฏูุซ webhookService.ts
```typescript
async sendNewRequestTypeWebhook(requestData: any) {
  if (!this.isEnabled) return;
  
  try {
    await telegramService.sendNewRequestTypeNotification(requestData);
    console.log('โ ุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ุงูุทูุจ ุงูุฌุฏูุฏ ุฅูู ุงูุชูููุฌุฑุงู');
  } catch (error) {
    console.error('โ ุฎุทุฃ ูู ุฅุฑุณุงู ุงูุฅุดุนุงุฑ:', error);
  }
}
```

### ุชุฎุตูุต ุงูุฑุณุงุฆู

#### ุชุบููุฑ ูุต ุงูุฅุดุนุงุฑุงุช
```typescript
private formatRequestNotification(requestData: RequestData): string {
  // ุชุฎุตูุต ุงููุต ุญุณุจ ุงูุญุงุฌุฉ
  let message = `
${this.getRequestTypeEmoji(requestData.type)} <b>${requestData.title}</b>
// ... ุจุงูู ุงูุชูุณูู
  `;
  
  return message.trim();
}
```

#### ุฅุถุงูุฉ ุฃุฒุฑุงุฑ ูุฎุตุตุฉ
```typescript
private getRequestReplyMarkup(requestData: RequestData): any {
  const buttons = [];
  
  // ุฅุถุงูุฉ ุฃุฒุฑุงุฑ ูุฎุตุตุฉ
  buttons.push([
    {
      text: 'ุฒุฑ ูุฎุตุต',
      callback_data: `custom_action_${requestData.id}`
    }
  ]);
  
  return {
    inline_keyboard: buttons
  };
}
```

## ุงูุฃูุงู

### ุญูุงูุฉ ุงูุจูุงูุงุช
- ุฌููุน ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ ูุดูุฑุฉ
- ุงุณุชุฎุฏุงู HTTPS ููุงุชุตุงูุงุช
- ุงูุชุญูู ูู ุงูุตูุงุญูุงุช ูุจู ุงูุฅุฑุณุงู

### ุฅุนุฏุงุฏุงุช ุงูุฎุตูุตูุฉ
- ุชุฃูุฏ ูู ุฃู ุงูุจูุช ูุง ูุดุงุฑู ูู ูุฌููุนุงุช ุนุงูุฉ
- ุงุณุชุฎุฏู chat ID ุฎุงุต ููุฃุฏูู
- ุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงูุฎุตูุตูุฉ ูู ุงูุชูููุฌุฑุงู

## ุงูุฏุนู

### ุงููุณุงุนุฏุฉ
ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:
1. ุชุญูู ูู ุณุฌูุงุช ุงูุฃุฎุทุงุก ูู ูุญุฏุฉ ุงูุชุญูู
2. ุชุฃูุฏ ูู ุตุญุฉ ุงูุฅุนุฏุงุฏุงุช
3. ุงุฎุชุจุฑ ุงูุงุชุตุงู ุจุงุณุชุฎุฏุงู ุฒุฑ ุงูุงุฎุชุจุงุฑ

### ุงูุชุญุฏูุซุงุช
- ุงููุธุงู ูุงุจู ููุชุญุฏูุซ ูุงูุชูุณูุน
- ูููู ุฅุถุงูุฉ ุฃููุงุน ุทูุจุงุช ุฌุฏูุฏุฉ ุจุณูููุฉ
- ุฏุนู ูุงูู ููุบุชูู ุงูุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ

---

**ููุงุญุธุฉ**: ุชุฃูุฏ ูู ุงุฎุชุจุงุฑ ุงููุธุงู ูุจู ุงุณุชุฎุฏุงูู ูู ุงูุฅูุชุงุฌุ ูุงุณุชุฎุฏู ุงูุฅุดุนุงุฑุงุช ุงูุชุฌุฑูุจูุฉ ููุชุฃูุฏ ูู ุตุญุฉ ุงูุฅุนุฏุงุฏุงุช.
